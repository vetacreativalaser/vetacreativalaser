import{c as y,v as g,r,j as e,m as j,I as m,B as k,t as i}from"./index-1a280ec8.js";import{L as p}from"./label-a8afc4d5.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=y("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),C=()=>{const h=g(),[o,f]=r.useState(""),[l,x]=r.useState(""),[n,d]=r.useState(!1),[u,c]=r.useState(null),[b,v]=r.useState("");r.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("token");if(!a){c(!1);return}v(a),fetch("https://dspsrnprvrpjrkicxiso.functions.supabase.co/verify-reset-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a})}).then(t=>t.json()).then(t=>{t.valid?c(!0):c(!1)}).catch(()=>c(!1))},[]);const w=async s=>{if(s.preventDefault(),o!==l){i({title:"Error",description:"Las contraseñas no coinciden.",variant:"destructive"});return}if(o.length<6){i({title:"Error",description:"La contraseña debe tener al menos 6 caracteres.",variant:"destructive"});return}d(!0);try{const a=await fetch("https://dspsrnprvrpjrkicxiso.functions.supabase.co/reset-password-from-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:b,newPassword:o})}),t=await a.json();if(a.ok&&t.success)i({title:"Contraseña restablecida",description:"Tu contraseña ha sido actualizada exitosamente."}),h("/auth?mode=login");else throw new Error(t.error||"No se pudo restablecer la contraseña.")}catch(a){i({title:"Error",description:a.message,variant:"destructive"})}finally{d(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center py-8 px-4 sm:px-6 lg:px-8 bg-gray-50",children:e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-md w-full space-y-8 p-8 sm:p-10 bg-white shadow-xl border border-gray-200",children:[e.jsxs("div",{children:[e.jsx(N,{className:"mx-auto h-12 w-auto text-black",strokeWidth:1.5}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-semibold tracking-tight text-black",children:"Restablecer Contraseña"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Crea una nueva contraseña para tu cuenta."})]}),u===!1?e.jsx("p",{className:"text-red-500 text-sm text-center",children:"El enlace ya fue usado o ha caducado. Solicita uno nuevo."}):e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:w,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(p,{htmlFor:"new-password",children:"Nueva contraseña"}),e.jsx(m,{id:"new-password",name:"newPassword",type:"password",required:!0,value:o,onChange:s=>f(s.target.value),className:"mt-1 border-gray-300 focus:border-black focus:ring-black",placeholder:"Nueva contraseña",disabled:n})]}),e.jsxs("div",{children:[e.jsx(p,{htmlFor:"confirm-password",children:"Confirmar nueva contraseña"}),e.jsx(m,{id:"confirm-password",name:"confirmPassword",type:"password",required:!0,value:l,onChange:s=>x(s.target.value),className:"mt-1 border-gray-300 focus:border-black focus:ring-black",placeholder:"Confirmar contraseña",disabled:n})]})]}),e.jsx("div",{children:e.jsx(k,{type:"submit",className:"w-full bg-black text-white hover:bg-gray-800",disabled:n||u!==!0,children:n?"Restableciendo...":"Restablecer Contraseña"})})]})]})})};export{C as default};
