import{c as w,r as u,u as N,j as e,m as l,L as x,B as h,s as p,t as n}from"./index-7f1f9d48.js";import{H as k}from"./heart-4e0712cb.js";import{S as E}from"./shopping-bag-6dcfffa2.js";import{T as _}from"./trash-2-55b83d28.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=w("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),L=()=>{const[d,c]=u.useState([]),{user:i}=N(),[v,o]=u.useState(!0);u.useEffect(()=>{(async()=>{if(i){o(!0);const{data:t,error:a}=await p.from("favorites").select("product_id").eq("user_id",i.id);if(a){console.error("Error fetching favorite IDs:",a),n({title:"Error",description:"No se pudieron cargar los favoritos.",variant:"destructive"}),o(!1);return}if(t&&t.length>0){const r=t.map(j=>j.product_id),{data:m,error:f}=await p.from("products").select("*").in("id",r);f?(console.error("Error fetching product details:",f),n({title:"Error",description:"No se pudieron cargar los detalles de los productos favoritos.",variant:"destructive"})):c(m||[])}else c([]);o(!1)}else c([]),o(!1)})()},[i]);const b=async s=>{if(!i)return;o(!0);const{error:t}=await p.from("favorites").delete().eq("user_id",i.id).eq("product_id",s);if(t)n({title:"Error",description:"No se pudo eliminar el favorito.",variant:"destructive"});else{const a=d.find(r=>r.id===s);c(r=>r.filter(m=>m.id!==s)),n({title:"Eliminado de Favoritos",description:a==null?void 0:a.name})}o(!1)},g=s=>{const t="642571133",a=encodeURIComponent(`¡Hola! Estoy interesado/a en el producto "${s}" de mis favoritos.`);window.open(`https://wa.me/${t}?text=${a}`,"_blank")},y=s=>{try{const t=typeof s=="string"?JSON.parse(s):s;return(t==null?void 0:t.type)==="fixed"?t.value||t.fixedPrice:"var"}catch{return"var"}};return v?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-black"})}):e.jsx("div",{className:"min-h-screen py-8 bg-white text-black",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(l.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-10",children:[e.jsx(k,{className:"h-12 w-12 text-black mx-auto mb-4",strokeWidth:1.5}),e.jsx("h1",{className:"text-4xl font-semibold text-black mb-3",children:"Mis Favoritos"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Tus productos preferidos guardados en un solo lugar."})]}),d.length===0?e.jsxs(l.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12",children:[e.jsx(E,{className:"h-16 w-16 text-gray-400 mx-auto mb-6",strokeWidth:1}),e.jsx("p",{className:"text-xl text-gray-500 mb-4",children:"Tu lista de favoritos está vacía."}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Añade productos que te gusten para verlos aquí."}),e.jsx(x,{to:"/productos",children:e.jsx(h,{variant:"outline",className:"border-black text-black hover:bg-black hover:text-white",children:"Explorar Productos"})})]}):e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:d.map((s,t)=>{var a;return e.jsxs(l.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:t*.1},className:"flex flex-col sm:flex-row items-center justify-between p-4 border border-gray-200 bg-white hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-4 w-full sm:w-auto mb-4 sm:mb-0",children:[e.jsx(x,{to:`/productos/${s.id}`,className:"block w-20 h-20 bg-gray-100 overflow-hidden shrink-0 rounded",children:e.jsx("img",{className:"w-full h-full object-cover",alt:((a=s.image_alts)==null?void 0:a[0])||s.name,src:(()=>{try{const r=typeof s.image_urls=="string"?JSON.parse(s.image_urls):s.image_urls;return Array.isArray(r)&&r.length>0?r[0]:"https://images.unsplash.com/photo-1598020856638-cbc3b47bbada"}catch{return"https://images.unsplash.com/photo-1598020856638-cbc3b47bbada"}})()})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx(x,{to:`/productos/${s.id}`,children:e.jsx("h2",{className:"text-lg font-medium text-black hover:underline",children:s.name})}),e.jsxs("p",{className:"text-gray-500 text-sm",children:[y(s.price)," €"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[e.jsxs(h,{variant:"outline",size:"sm",className:"border-gray-300 hover:border-black text-xs w-full sm:w-auto",onClick:()=>g(s.name),children:[e.jsx(C,{className:"mr-2 h-3 w-3 sm:hidden md:inline-block"})," Contactar"]}),e.jsxs(h,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-red-500 w-full sm:w-auto",onClick:()=>b(s.id),children:[e.jsx(_,{className:"mr-2 h-3 w-3 sm:hidden md:inline-block"})," Eliminar"]})]})]},s.id)})})]})})};export{L as default};
